<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Carlos Ferreira & Contributors" /><link rel="canonical" href="https://ibm.github.io/maximo-labs/utilities_devicedata/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Create Utilities Predict Group and Upload Sensor Data - Maximo APM V8.7 Hands On Lab</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Create Utilities Predict Group and Upload Sensor Data";
        var mkdocs_page_input_path = "utilities_devicedata.md";
        var mkdocs_page_url = "/maximo-labs/utilities_devicedata/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Maximo APM V8.7 Hands On Lab
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../..">Get back to Maximo Labs</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Maximo APM V8.7.0 Lab</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Welcome to the Lab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../get_started/">Get Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prereqs/">Pre-Requisites</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Exercises</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../setup_watson_studio/">Setup Watson Studio for Predict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hpu_models/">Understand Health and Predict - Utilities Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../data_preparation/">Data Preparation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../asset_data_loader/">Load Utilities Data Into Manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utilities_score_notebook/">Create Health Scores Using Utilities Notebooks</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Create Utilities Predict Group and Upload Sensor Data</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#pre-requisites">Pre-requisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#gather-notebooks-and-csv-files">Gather notebooks and CSV Files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#upload-and-start-the-fast-start-data-loader-notebook">Upload and Start the Fast Start Data Loader Notebook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#run-the-notebook">Run the Notebook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#confirm-data-upload-and-prediction-groups">Confirm Data Upload and Prediction Groups</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#error-handling">Error Handling</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#update-dateframe-header">Update DateFrame Header</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utilities_anomaly_detection/">Train and Register Anomaly Detection Model for Utilities Assets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utilities_EOL/">Train and Register End of Life Curve for Utilities Assets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utilities_Failure_date/">Train and Register Predicted Failure Date for Utilities Assets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utilities_Failure_Probability/">Train and Register Failure Probability for Utilities Assets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../data_dictionary/">Pump Data Dictionary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fast_start_loader/">Load Pump Data Into Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../health_score/">Asset Health Scoring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../asset_investment/">Asset Investment Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../appconnect_install/">Install and Configure App Connect</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../release_notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../copyright">Copyright</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Maximo APM V8.7 Hands On Lab</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Exercises</li>
      <li class="breadcrumb-item active">Create Utilities Predict Group and Upload Sensor Data</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="create-utilities-predict-group-and-upload-sensor-data">Create Utilities Predict Group and Upload Sensor Data</h1>
<p>Maximo Predict comes with notebook templates to assist in streamlining data uploads to Maximo. This notebook will create the following resources using provided csv files:</p>
<ul>
<li>Device Data in Monitor</li>
<li>Device Asset Mapping</li>
<li>Predict Groups</li>
</ul>
<p>These instructions use the notebook named <code>2_FastStartLoader-Predict.ipynb</code> file with the Substation Transformer for Health and Predict for Utilities Demo Assets. Note that this uses simulated Pump Data for the sensor readings.</p>
<p>In this exercise you will use Watson Studio and Health and Predict - Utilities to:</p>
<ol>
<li><a href="#gather_files">Gather notebook and CSV files</a> for all data to be uploaded</li>
<li><a href="#FastStart_notebook">Upload the and Run the Fast Start HPU Data Loader Notebooks</a> using a template to upload new Device Data and Predict Groups into Maximo</li>
<li><a href="#confirm_upload">Confirm</a> the Data Has been uploaded for your assets</li>
<li><a href="#error_handling">Handle Errors</a> that may come up in the process</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must complete the previous exercise for <a href="../setup_watson_studio/">Setup Watson Studio</a> before you start this exercise.</p>
</div>
<h2 id="pre-requisites">Pre-requisites</h2>
<ul>
<li>Review Predict documentation for the <a href="https://www.ibm.com/docs/en/mhmpmh-and-p-u/8.5.0?topic=overviews-maximo-predict-850">list of available models</a>.</li>
<li>Ensure your MAS Predict environment is running and you have access.  Try your server URL that might look something like: <a href="https://main.predict.ivt11rel87.ivt.suite.myhost.com/ibm/pmi/service/rest/system/info">https://main.predict.ivt11rel87.ivt.suite.myhost.com/ibm/pmi/service/rest/system/info</a></li>
<li>Ensure you have Access to Asset data files for the Health and Predict Utilities Demo Data</li>
<li>Complete the <a href="../asset_data_loader/">Load Data into Manage</a> lab for the Utilities data.</li>
<li>Complete the <a href="../utilities_score_notebook/">Load Utilities Health Scores via Notebook</a> lab </li>
<li>Have the following information from the previous lab: <code>SITE_ID</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is best to perform this lab in your own Watson Studio Project created using <a href="../setup_watson_studio/">Setup Watson Studio</a> instructions. If you are using a shared project, ensure you append each file uploaded with your initials and update the file paths in the notebooks to include that change.</p>
</div>
<h2 id="gather-notebooks-and-csv-files">Gather notebooks and CSV Files</h2>
<p><a name="gather_files"></a></p>
<ol>
<li>
<p>Ensure you have the <code>2_FastStartLoader-Predict.ipynb</code> notebook from the github as outlined in <a href="../asset_data_loader/#gather_files">Load Data into Manage</a>.</p>
</li>
<li>
<p>In that folder, ensure you have 3 csv files under <code>csv &gt; predict_csv_st</code> containing asset installation information, asset failure dates and sensor data</p>
</li>
<li>
<p>Open the <code>hpu_st_failure_data_afm_vel_timeshifted_v17.csv</code> and update the Site ID to your site ID from <a href="../asset_data_loader/">Load Data into Manage</a>
<img alt="Cell Updates" src="../img/hpu_2fsl_1.png" /> </p>
</li>
<li>
<p>In the <code>notebooks</code> folder there should be a file titled <code>2_FastStartLoader-Predict.ipynb</code></p>
</li>
</ol>
<h2 id="upload-and-start-the-fast-start-data-loader-notebook">Upload and Start the Fast Start Data Loader Notebook</h2>
<p><a name="FastStart_notebook"></a></p>
<ol>
<li>
<p>Upload or open the Fast Start Data Loader template notebook to your Project. Use the steps from the previous exercise <a href="../setup_watson_studio/">Add Notebook From File to a Watson Studio Project</a>  Rename the notebook template by prepending your initials to the template.  If you already have uploaded the notebook, open it with Watson Studio.
Select the <code>2_FastStartLoader-Predict.ipynb</code> notebook template. </p>
</li>
<li>
<p>Open the notebook.  Click on the <code>pencil</code> icon next to your notebook </p>
</li>
<li>
<p>If the notebook fails to start, restart it.  Click on the <code>i</code> icon , <code>Environment</code> tab,  <code>Running status</code> drop down select box and choose <code>Restart</code>
<img alt="Restarting Environment" src="../img/HPU_dataloader_3.png" /></p>
</li>
</ol>
<h2 id="run-the-notebook">Run the Notebook</h2>
<p><a name="run_notebooks"></a></p>
<ol>
<li>
<p>Run the first cell two cells. These cells are setting up the files required to complete the notebook.</p>
</li>
<li>
<p>Read the introduction for details on the notebook and how it fits into the Maximo Predict process.</p>
</li>
<li>
<p>Ensure you have a 'Predict_Envs.json' file uploaded. If one is not provided, follow the instructions in <a href="../setup_watson_studio/">set up Watson Studio</a>under the 'Get URL' section to gather the <code>APM_ID</code>, <code>APM_API_BASE_URL</code>, and <code>APM_API_KEY</code> to create a JSON file containing the credentials and upload to Watson Studio with your initials prepended to the file name.</p>
</li>
<li>
<p>Run the cell to open the JSON file.</p>
</li>
<li>
<p>Run the cell to uninstall the pmlib. This is done to ensure the right version is installed later in the process.</p>
</li>
<li>
<p>Run the following two cells to set up variables required for the environment and the structure of the JSON file that will be stored on completion of the notebook. Note that both should produce an output without error.
<img alt="Cell Updates" src="../img/hpu_2fsl_2.png" /> </p>
</li>
<li>
<p>Run the following 3 cells to install pmlib and import the additional required libraries</p>
</li>
<li>
<p>Update <code>default_site_id = 'EULARGE1'</code> to <code>default_site_id = '{your site id}'</code></p>
</li>
<li>
<p>Run the cell to define your device type name, site id, and your asset group label. Make a note of the resulting output. This is the asset group label that will be the name of your predict group.
<img alt="Cell Updates" src="../img/hpu_2fsl_3.png" /> </p>
</li>
<li>
<p>Run the following cell to import the csv containing the asset data and update the dataframe's data types</p>
</li>
<li>
<p>Run the next cell to import the sensor data and update the data frame to match the desired format. This will replace the device type with the one defined two cells above and adds the asset id for each row.</p>
</li>
<li>
<p>Run the following cell to rename the <code>timestamp</code> column to the desired name and data type.</p>
</li>
<li>
<p>Run the following cell to create a list of the different Device Ids that will be created. Note that not all the assets have an associated device data.
<img alt="Device Ids" src="../img/hpu_2fsl_4.png" /> </p>
</li>
<li>
<p>Run the next cell to upload the failure data as a dataframe</p>
</li>
<li>
<p>Run the next cell to create add the devices to the asset data table imported in step 10</p>
</li>
<li>
<p>Run the following cell to construct the asset device mapping table that will be needed for later in the notebook
<img alt="asset device mapping" src="../img/hpu_2fsl_5.png" /> </p>
</li>
<li>
<p>Run the next 6 cells to delete the data. These cells do NOT have to be run if this is the first time uploading data. If you need to re-upload the sensor data or recreate the group then the cells are required to be run. The final cell has a 5 minute delay to ensure the data gets fully deleted. Notice there is a commented out cell that would delete your assets. This is because we uploaded assets using the <a href="../asset_data_loader/">Load Data into Manage</a> and did not want to delete the extra data we uploaded.</p>
</li>
<li>
<p>Run the next cell following the delete cells to import the Maximo api calls and clean up the data frames.</p>
</li>
<li>
<p>Run the next cell to confirm the asset_group_label_afm that will be the name of your predict group</p>
</li>
<li>
<p>The next few cells will be inserting the asset data into Maximo. Run the first cell to confirm the asset data to be imported</p>
</li>
<li>
<p>Run the next two cells to shift the time of the sensor data to two days ago (to be more recent) and the failure dates accordingly</p>
</li>
<li>
<p>Note that the data is now in the current year</p>
</li>
</ol>
<p><img alt="Shifted Data" src="../img/hpu_2fsl_6.png" /> </p>
<ol>
<li>
<p>The next two commented out cells will create the assets and asset attributes. Since this information was uploaded earlier in the lab, they do not have to be run</p>
</li>
<li>
<p>Run the next cell to check if the failure code exists in your organization. If it does not, it will create one.</p>
</li>
<li>
<p>Run the next cell to import the asset failure history</p>
</li>
<li>
<p>Run the following cell to define the functions to create the asset group and filter for that group</p>
</li>
<li>
<p>Run the next cell to use those functions to create the asset group filter and create teh asset group.</p>
</li>
<li>
<p>Run the next cell to get the asset group id for the recently created predict group. This will be stored in a json file and used in future notebooks.</p>
</li>
<li>
<p>Run the final cell in this section to view and note the asset group id</p>
</li>
<li>
<p>Run the first cell in the <code>Setup IOT Devices</code> section to update the column headers and view the dataframe along with the amount of data to be uploaded</p>
</li>
<li>
<p>Run the following cell to load in the training data for the models. This will set up the IOT devices and the associated sensor data.</p>
</li>
<li>
<p>Run the next cell to view the asset device mappings to be uploaded</p>
</li>
<li>
<p>Run the next cell to load the asset device mappings</p>
</li>
<li>
<p>Run the final three cells to save and view the data in the <code>fast_execution.json</code> file. Ensure the <code>asset_group_id</code> and the 34. Run the final three cells to save and view the data in the <code>fast_execution.json</code> file. Ensure the <code>asset_group_id</code> and the <code>device_type</code> match the values displayed throughout the notebook</p>
</li>
</ol>
<p><img alt="Shifted Data" src="../img/hpu_2fsl_7.png" /> </p>
<ol>
<li>The remaining cells will create scoring data for the predict group created. This is not being done since in the following labs, models will be created and assets will be scored for the created predict group at that time.</li>
</ol>
<h2 id="confirm-data-upload-and-prediction-groups">Confirm Data Upload and Prediction Groups</h2>
<p><a name="confirm_upload"></a></p>
<p>Confirm that the historical data was uploaded to Monitor.  Confirm that the Prediction group was created and linked to the model notebook template you created.</p>
<ol>
<li>
<p>Navigate to Maximo Health and Predict for Utilities within your environment</p>
</li>
<li>
<p>Use the left-hand menu to go into <code>Predict Grouping</code>
   <img alt="Predict Grouping" src="../img/hpu_fs11.png" /> </p>
</li>
<li>
<p>Ensure your asset group is available in the list and confirm your asset is available within the group.
 <img alt="Predict Grouping" src="../img/hpu_2fsl_8.png" /> </p>
</li>
<li>
<p>Navigate to IOT within your environment.  Under <code>devices</code>, search to ensure your <code>device</code> is there
<img alt="IOT Device" src="../img/hpu_2fsl_9.png" /></p>
</li>
<li>
<p>Navigate to <code>Device Types</code> and find your device type. Check that your <code>physical</code> and <code>logical interfaces</code> are active.</p>
</li>
<li>
<p>Navigate to Monitor and ensure your devices have data</p>
</li>
</ol>
<h2 id="error-handling">Error Handling</h2>
<p><a name="error_handling"></a></p>
<h3 id="update-dateframe-header">Update DateFrame Header</h3>
<p>If you receive an object attribute error for pandas, with a column header initialized in <a href="#part-2---install-the-maximo-predict-sdk">Part 2</a> step 10 listed similar to:
<img alt="Error" src="../img/hpu_fsl_error.png" /> 
Then follow these steps to replace your dataframe header to resolve this error.
1. Click into the cell that resulted in an error.</p>
<ol>
<li>
<p>In the menu, go to <code>Insert &gt; Cell Above</code> 
<img alt="Insert Cell Above" src="../img/hpu_fs6.png" /> </p>
</li>
<li>
<p>Rename the columns by adding the following code in the cell:
<code>{DataFrame_to_Change}.rename(columns={'{current_column_header}': site_id_col_name}, inplace=True)</code>
<code>{DataFrame_to_Change}.head()</code></p>
</li>
<li>
<p>Run the cell. The output should show the new header in the table.  For example: in order to change the <code>failure_data_afm_df</code> column header from <code>'site'</code> to the preferred header:
 <img alt="Renamed Header" src="../img/hpu_fs7.png" /> </p>
</li>
</ol>
<p>Congratulations you have loaded historical data and created Predict Groups linking your device's metrics inputs to list of assets and notebook template that will be used to score predictions using Predict with Monitor device data!</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../utilities_score_notebook/" class="btn btn-neutral float-left" title="Create Health Scores Using Utilities Notebooks"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../utilities_anomaly_detection/" class="btn btn-neutral float-right" title="Train and Register Anomaly Detection Model for Utilities Assets">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../utilities_score_notebook/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../utilities_anomaly_detection/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
